# Rime schema
# encoding: utf-8
# æœ™æœˆæ‹¼éŸ³è‡ªå®šç¾©ä¿®æ”¹ï¼Œç”¨æ–¼è‡ªå¸¶çš„é»˜èªæœ™æœˆæ‹¼éŸ³
# å‚è€ƒå®šåˆ¶æŒ‡å— https://github.com/rime/home/wiki/RimeWithSchemata#%E5%AE%9A%E8%A3%BD%E6%8C%87%E5%8D%97
patch:
    # å¢åŠ emoji https://github.com/rime/rime-emoji/tree/master
  emoji:
    opencc_config: emoji.json
    option_name: emoji
    tips: none
    inherit_comment: false
  # ç»“æŸemoji
  #
  dependencies:
    - melt_eng
  #
  translator/dictionary: luna_pinyin.extended   # ä½¿ç”¨è¯åº“luna_pinyin.extended.dict.ymlä»¥æ‰©å±•è¯åº“
  translator/enable_user_dict: true       # å¯ç”¨ç”¨æˆ·è¯å…¸ï¼ŒåŠ¨æ€è¯é¢‘
  translator/nitial_quality: 1.5
  translator/contextuals: true  # å¼€å¯å…«è‚¡æ–‡
  translator/enable_charset_filter: true  # è¿‡æ»¤ç”Ÿåƒ»å­—
  #translator:
  #  initial_quality: 1.2          # æ‹¼éŸ³çš„æƒé‡åº”è¯¥æ¯”è‹±æ–‡å¤§
  #  dictionary: luna_pinyin     # æŒ‚è½½è¯åº“ melt_eng.dict.yaml
  #  contextuals: true  # å¼€å¯å…«è‚¡æ–‡
  #  preedit_format:
  #  - xform/([nl])v/$1Ã¼/
  #  - xform/([nl])ue/$1Ã¼e/
  #  - xform/([jqxy])v/$1u/
  
  # æ¬¡ç¿»è¯‘å™¨ï¼Œè‹±æ–‡
  melt_eng:
    dictionary: melt_eng     # æŒ‚è½½è¯åº“ melt_eng.dict.yaml
    enable_sentence: false   # ç¦æ­¢é€ å¥
    enable_user_dict: true  # å¯ç”¨ç”¨æˆ·è¯å…¸ï¼ŒåŠ¨æ€è¯é¢‘
    initial_quality: 0     # åˆå§‹æƒé‡
    comment_format:          # è‡ªå®šä¹‰æç¤ºç 
      - xform/.*//           # æ¸…ç©ºæç¤ºç 
  #
  switches/@2/reset: 1    #è¡¨ç¤ºå°‡ switcher åˆ—è¡¨ä¸­çš„ç¬¬ä¸‰å€‹å…ƒç´ ï¼ˆå³ simplification é–‹é—œï¼‰çš„åˆå§‹å€¼é‡è¨­çˆ²ç‹€æ…‹1ï¼ˆå³ã€Œç®€ä½“ã€ï¼‰ã€‚
  switches/@next:         #è¡¨ç¤ºåœ¨ switcher åˆ—è¡¨ä¸­æœ€åå¢åŠ ä¸€ä¸ªé¡¹ç›®
    name: emoji
    reset: 1
    states: [ "ğŸˆšï¸", "ğŸˆ¶ï¸" ]
  #
  switches/@after 4:
    options: [utf8, gbk, gb2312]    # (â€»2) å­—ç¬¦é›†é€‰å• 
    reset: 1                        # é»˜è®¤ GBK
    states:                         # å¯ä»¥é€šè¿‡åˆ‡åŠŸèƒ½é”®ï¼Œåˆ‡è‡³ UTF8 ç­‰è¶…å¤§å­—ç¬¦é›†
      - UTF-8
      - GBK
      - GB2312
  #
  engine/processors/@before 0:
    lua_processor@select_character      # ä»¥è¯å®šå­—

  #
  engine/translators/@after 0:
    lua_translator@date_translator      # æ—¶é—´ã€æ—¥æœŸã€æ˜ŸæœŸ
  engine/translators/@after 1:
    lua_translator@lunar                # å†œå†
  engine/translators/@after 2:
    table_translator@melt_eng           # è‹±æ–‡è¾“å…¥
  engine/translators/@after 3:
    lua_translator@cn_en                # ä¸­è‹±æ··åˆè¯æ±‡
  engine/translators/@after 4:
    lua_translator@unicode              # Unicode
  engine/translators/@after 5:
    lua_translator@number_translator    # æ•°å­—ã€é‡‘é¢å¤§å†™
  engine/translators/@after 6:
    lua_translator@custom_phrase        # è‡ªå®šä¹‰çŸ­è¯­ custom_phrase.txt

  #
  engine/filters/@before 0:
    simplifier@emoji                    # Emoji
  engine/filters/@before 1:
    simplifier@traditionalize           # ç®€ç¹åˆ‡æ¢
  engine/filters/@before 2:
    lua_filter@v_filter                 # v æ¨¡å¼ symbols ä¼˜å…ˆï¼ˆå¦åˆ™æ˜¯è‹±æ–‡ä¼˜å…ˆï¼‰
  engine/filters/@before 3:
    lua_filter@autocap_filter           # è‹±æ–‡è‡ªåŠ¨å¤§å†™
  engine/filters/@before 4:
    lua_filter@reduce_english_filter    # é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®
  engine/filters/@before 5:
    lua_filter@long_word_filter         # é•¿è¯ä¼˜å…ˆ
  engine/filters/@before 6:
    lua_filter@corrector                # é”™éŸ³é”™å­—æç¤º 
  engine/filters/@before 7:
    lua_filter@pin_cand_filter          # ç½®é¡¶å€™é€‰é¡¹ï¼ˆé¡ºåºè¦æ±‚ï¼šç½®é¡¶å€™é€‰é¡¹ > Emoji > ç®€ç¹åˆ‡æ¢ï¼‰
  engine/filters/@before 8:
    lua_filter@pin_cand_filter          # ç½®é¡¶å€™é€‰é¡¹ï¼ˆé¡ºåºè¦æ±‚ï¼šç½®é¡¶å€™é€‰é¡¹ > Emoji > ç®€ç¹åˆ‡æ¢ï¼‰


  # åæŸ¥ï¼šä¸¤åˆ†ï¼ˆæ‹¼å­—ï¼‰
  liangfen:
    dictionary: liangfen     # æŒ‚è½½ä¸¤åˆ†è¯å…¸ liangfen.dict.yaml
    prefix: "u"              # ä»¥ u å¼€å¤´æ¥åæŸ¥
    enable_completion: true  # è¡¥å…¨æç¤º
    # tips: ã€”ä¸¤åˆ†ã€•          # åæŸ¥æ—¶æ˜¾ç¤ºçš„æ–‡å­—ï¼Œå»ºè®®æ³¨é‡Šæ‰ï¼Œå¦åˆ™å¾ˆå¤š u å¼€å¤´çš„è‹±æ–‡å•è¯ä¹Ÿä¼šæ˜¾ç¤ºè¿™ä¸ª
  
  # Lua é…ç½®: æ—¥æœŸã€æ—¶é—´ã€æ˜ŸæœŸã€ISO 8601ã€æ—¶é—´æˆ³çš„è§¦å‘å…³é”®å­—
  date_translator:
    date: rq       # æ—¥æœŸï¼š 2022-11-29
    time: sj       # æ—¶é—´ï¼š 18:13
    week: xq       # æ˜ŸæœŸï¼š æ˜ŸæœŸäºŒ
    datetime: dt   # ISO 8601ï¼š 2022-11-29T18:13:11+08:00
    timestamp: ts  # æ—¶é—´æˆ³ï¼š 1669716794
  
  # Lua é…ç½®: é•¿è¯ä¼˜å…ˆï¼Œæå‡ count ä¸ªè¯è¯­ï¼Œæ’å…¥åˆ°ç¬¬ idx ä¸ªä½ç½®ã€‚
  # ç¤ºä¾‹ï¼šå°† 2 ä¸ªè¯æ’å…¥åˆ°ç¬¬ 4ã€5 ä¸ªå€™é€‰é¡¹ï¼Œè¾“å…¥ jie å¾—åˆ°ã€Œ1æ¥ 2è§£ 3å§ 4é¥¥é¥¿ 5ææ¶ã€
  long_word_filter:
    count: 2
    idx: 4
  
  # Lua é…ç½®: é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®
  # è¯¦ç»†ä»‹ç» https://dvel.me/posts/make-rime-en-better/#çŸ­å•è¯ç½®é¡¶çš„é—®é¢˜
  # æ­£å¸¸æƒ…å†µï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.rug 2.å¦‚æœ â€¦â€¦ ã€
  # é™ä½ä¹‹åï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.å¦‚æœ 2.rug â€¦â€¦ ã€
  reduce_english_filter:
    # é™ä½åˆ°ç¬¬ idx ä¸ªä½ç½®
    idx: 2
    # è¦é™ä½çš„å•è¯ï¼ŒåŒ¹é…çš„æ˜¯è¾“å…¥ç ï¼Œå³å…¨å°å†™ã€‚
    words: [rug, bus, ship, laos, bail, bam, bans, bib, bos, chic, chit, dab, dag,
    dal, dit, dub, dug, fab, gam, ger, gus, hem, hep, hud, kat, lam, lax, lex, lug,
    lux, moc, mos, mot, mum, nad, nay, nib, nip, pak, pap, pax, rig, rum, sac, sal,
    sax, sec, shin, sis, ska, slang, sus, tad, taj, tac, tic, yep, yum, fax, cain,
    key, mob, buy, dam, wap, yes, but, put, lag, buf, lip, aid, aim, dig, dim, din,
    dip, pail, cad, chap, bend]

  punctuator:
    full_shape:
      '\': "ã€"
      "/" : [ ï¼, "/", Ã· ]
      __include: default:/punctuator/full_shape  # ä» default.yaml å¯¼å…¥é…ç½®
    half_shape:
      '\': "ã€"
      "/" : [ "/", ï¼, Ã· ]
      __include: default:/punctuator/half_shape  # ä» default.yaml å¯¼å…¥é…ç½®
    symbols:
      __include: symbols_v:/symbols              # ä» symbols_v.yaml å¯¼å…¥é…ç½®

  recognizer/patterns:
    punct: "^v([0-9]|10|[A-Za-z]+)$"  # å“åº” symbols_v.yaml çš„ symbolsï¼Œç”¨ 'v' æ›¿æ¢ '/'
    reverse_lookup: "`[a-z]*'?$"
    unicode: "^U[a-f0-9]+"            # å“åº” Unicode
    number: "^R[0-9]+[.]?[0-9]*"      # å“åº” number_translator
    
  